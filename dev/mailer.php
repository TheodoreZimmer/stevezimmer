<?//allowed name field characters: A-Za-z0-9 space - " 'function validateName($name) {    if(! preg_match('/^[A-Za-z0-9 \s\040\-"\']+$/' , $name)){        return false;    }    return true;}function validateMail($mail) {    $mail = strtoupper($mail);    return preg_match("/^[A-Z0-9._%-]+@([A-Z0-9-]+\.{1})+[A-Z]{2,4}$/", $mail);}//disallowed subject line chars: ~ ` ^ (_ ? not sure) { } \ | [ ] < >function validateSubject($subject) {    if(! preg_match('/^[A-Z0-9a-z\040%!@#?\$&\.;"\'\(\)\-\+\*\/,:=]+$/', $subject)){        return false;    }    return true;}//disallowed message line chars: ~ ` ^ (_ ? not sure) { } \ | [ ] < >function validateMessage($message) {    if(! preg_match('/[A-Z0-9a-z\040%!@#?\$&\.;"\'\(\)\-\+\*\/,:=\n]+/', $message)){        return false;    }    return true;}$sender_name = stripslashes($_POST['name']);$sender_mail = stripslashes($_POST['mail']);$subject = "FROM-SITE: ". stripslashes($_POST['subject']);$message = str_replace("^", "\r", stripslashes($_POST['message']));if(validateName($sender_name)){    if(validateMail($sender_mail)){        if(validateSubject($subject)){            if(validateMessage($message)){                $message = str_replace("\n.", "\n..", $message);//fixes a windows bug                //must be broken up into lines of no more than 70 chars per line                $message = wordwrap($message, 70);                $headers = 'From: '.$sender_name ." <".$sender_mail.">\r\n".                           'Reply-To: '.$sender_name." <".$sender_mail . ">\r\n".                           'X-Mailer: PHP/' . phpversion() . "\r\n";                $mailto = "stevezimmertu@gmail.com";                if(mail($mailto, $subject, $message, $headers)){                    echo '1';                }else{                    echo '0';                }            }else{                echo '2,3';            }        }else{            echo '2,2';        }    }else{        echo '2,1';    }}else{    echo '2,0';}?>